# Leaf API

ä¸€ä¸ªåŸºäº Go + Gin å¼€å‘çš„åšå®¢ç³»ç»Ÿåç«¯æœåŠ¡ï¼Œé¡¹ç›®æ¶æ„å‚è€ƒäº† [Kratos](https://go-kratos.dev/) çš„åˆ†å±‚è®¾è®¡ç†å¿µï¼ŒåŒæ—¶ç»“åˆå®é™…ä¸šåŠ¡éœ€æ±‚åšäº†é€‚é…å’Œç®€åŒ–ã€‚

å‰ç«¯éƒ¨ç½²åœ°å€ï¼š
- ç½‘ç«™ç«¯ï¼šhttps://github.com/ydcloud-dy/leaf-ui-frontend
- ç®¡ç†ç«¯ï¼šhttps://github.com/ydcloud-dy/leaf-ui-backend
## ğŸ“‹ ç›®å½•

- [æŠ€æœ¯æ ˆ](#-æŠ€æœ¯æ ˆ)
- [é¡¹ç›®æ¶æ„](#-é¡¹ç›®æ¶æ„)
- [ç›®å½•ç»“æ„](#-ç›®å½•ç»“æ„)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
  - [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
  - [æœ¬åœ°å¼€å‘](#æœ¬åœ°å¼€å‘)
- [éƒ¨ç½²æ–¹å¼](#-éƒ¨ç½²æ–¹å¼)
  - [è£¸éƒ¨ç½²](#è£¸éƒ¨ç½²)
  - [Docker éƒ¨ç½²](#docker-éƒ¨ç½²)
  - [Docker Compose éƒ¨ç½²](#docker-compose-éƒ¨ç½²)
  - [Kubernetes éƒ¨ç½²](#kubernetes-éƒ¨ç½²)
- [é…ç½®è¯´æ˜](#-é…ç½®è¯´æ˜)
- [API æ–‡æ¡£](#-api-æ–‡æ¡£)
  - [Swagger æ–‡æ¡£](#swagger-æ–‡æ¡£æ¨è)
  - [ç®¡ç†åå° API](#ç®¡ç†åå°-api)
  - [åšå®¢å‰å° API](#åšå®¢å‰å°-api)
- [å¼€å‘ç›¸å…³](#-å¼€å‘ç›¸å…³)

## ğŸ›  æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Go 1.21+
- **Web æ¡†æ¶**: Gin
- **ORM**: GORM
- **æ•°æ®åº“**: MySQL 8.0
- **ç¼“å­˜**: Redis 7.x
- **å¯¹è±¡å­˜å‚¨**: é˜¿é‡Œäº‘ OSS
- **è®¤è¯**: JWT
- **æ—¥å¿—**: Logrus + Lumberjack
- **é…ç½®ç®¡ç†**: Viper
- **ä¾èµ–æ³¨å…¥**: Wire

## ğŸ— é¡¹ç›®æ¶æ„

é¡¹ç›®é‡‡ç”¨äº†ç±»ä¼¼ Kratos çš„åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œä¸è¿‡åšäº†ä¸€äº›ç®€åŒ–å’Œè°ƒæ•´ä»¥é€‚åº”å®é™…éœ€æ±‚ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HTTP Layer    â”‚  Gin è·¯ç”± + ä¸­é—´ä»¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Service Layer  â”‚  å¤„ç† HTTP è¯·æ±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Biz Layer    â”‚  ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Data Layer    â”‚  æ•°æ®è®¿é—®å±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Model Layer    â”‚  æ•°æ®æ¨¡å‹ï¼ˆPO/DTOï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ç®€å•è¯´ä¸‹å„å±‚çš„èŒè´£ï¼š

- **HTTP Layer**: è·¯ç”±é…ç½®ã€ä¸­é—´ä»¶ï¼ˆJWT è®¤è¯ã€æ—¥å¿—ã€è·¨åŸŸç­‰ï¼‰
- **Service Layer**: æ¥æ”¶ HTTP è¯·æ±‚ï¼Œåšå‚æ•°éªŒè¯ï¼Œè°ƒç”¨ Biz å±‚å¤„ç†ï¼Œè¿”å›å“åº”
- **Biz Layer**: è¿™æ˜¯æ ¸å¿ƒï¼Œæ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½åœ¨è¿™é‡Œï¼Œä¿æŒä¸ HTTP æ— å…³
- **Data Layer**: è´Ÿè´£å’Œæ•°æ®åº“ã€Redis æ‰“äº¤é“ï¼Œç”¨çš„æ˜¯ Repository æ¨¡å¼
- **Model Layer**: æ•°æ®æ¨¡å‹ï¼Œåˆ†ä¸º POï¼ˆæ•°æ®åº“æ¨¡å‹ï¼‰å’Œ DTOï¼ˆæ¥å£ä¼ è¾“å¯¹è±¡ï¼‰

è¿™æ ·åˆ†å±‚çš„å¥½å¤„æ˜¯èŒè´£æ¸…æ™°ï¼Œæ”¹åŠ¨æŸä¸€å±‚ä¸ä¼šå½±å“å…¶ä»–å±‚ï¼Œæµ‹è¯•èµ·æ¥ä¹Ÿæ–¹ä¾¿ã€‚

## ğŸ“‚ ç›®å½•ç»“æ„

```
.
â”œâ”€â”€ cmd/                    # å‘½ä»¤è¡Œå…¥å£
â”‚   â”œâ”€â”€ app.go             # åº”ç”¨åˆå§‹åŒ–
â”‚   â”œâ”€â”€ injector.go        # ä¾èµ–æ³¨å…¥ï¼ˆWireç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ wire.go            # Wireé…ç½®
â”‚   â””â”€â”€ fix_images/        # å›¾ç‰‡ä¿®å¤å·¥å…·
â”œâ”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ config.go          # é…ç½®ç»“æ„å®šä¹‰
â”œâ”€â”€ deploy/                 # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ docker/            # Dockerç›¸å…³
â”‚   â”œâ”€â”€ k8s/               # Kubernetesé…ç½®
â”‚   â”œâ”€â”€ nginx/             # Nginxé…ç½®
â”‚   â””â”€â”€ scripts/           # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”œâ”€â”€ internal/               # å†…éƒ¨ä»£ç ï¼ˆä¸å¯¹å¤–æš´éœ²ï¼‰
â”‚   â”œâ”€â”€ biz/               # ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆUseCaseï¼‰
â”‚   â”‚   â”œâ”€â”€ article.go     # æ–‡ç« ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ auth.go        # è®¤è¯ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ blog.go        # åšå®¢ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ user.go        # ç”¨æˆ·ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ data/              # æ•°æ®è®¿é—®å±‚ï¼ˆRepositoryï¼‰
â”‚   â”‚   â”œâ”€â”€ article.go     # æ–‡ç« æ•°æ®è®¿é—®
â”‚   â”‚   â”œâ”€â”€ user.go        # ç”¨æˆ·æ•°æ®è®¿é—®
â”‚   â”‚   â”œâ”€â”€ category.go    # åˆ†ç±»æ•°æ®è®¿é—®
â”‚   â”‚   â”œâ”€â”€ tag.go         # æ ‡ç­¾æ•°æ®è®¿é—®
â”‚   â”‚   â””â”€â”€ comment.go     # è¯„è®ºæ•°æ®è®¿é—®
â”‚   â”œâ”€â”€ model/             # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ dto/           # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆè¯·æ±‚/å“åº”ï¼‰
â”‚   â”‚   â””â”€â”€ po/            # æŒä¹…åŒ–å¯¹è±¡ï¼ˆæ•°æ®åº“æ¨¡å‹ï¼‰
â”‚   â”œâ”€â”€ server/            # HTTPæœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ http.go        # HTTPæœåŠ¡å™¨åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ router.go      # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ middleware/    # ä¸­é—´ä»¶
â”‚   â””â”€â”€ service/           # æœåŠ¡å±‚ï¼ˆHTTP Handlerï¼‰
â”‚       â”œâ”€â”€ article.go     # æ–‡ç« æœåŠ¡
â”‚       â”œâ”€â”€ auth.go        # è®¤è¯æœåŠ¡
â”‚       â”œâ”€â”€ blog.go        # åšå®¢æœåŠ¡
â”‚       â”œâ”€â”€ user.go        # ç”¨æˆ·æœåŠ¡
â”‚       â”œâ”€â”€ category.go    # åˆ†ç±»æœåŠ¡
â”‚       â”œâ”€â”€ tag.go         # æ ‡ç­¾æœåŠ¡
â”‚       â”œâ”€â”€ comment.go     # è¯„è®ºæœåŠ¡
â”‚       â”œâ”€â”€ chapter.go     # ç« èŠ‚æœåŠ¡
â”‚       â”œâ”€â”€ stats.go       # ç»Ÿè®¡æœåŠ¡
â”‚       â”œâ”€â”€ settings.go    # è®¾ç½®æœåŠ¡
â”‚       â””â”€â”€ file.go        # æ–‡ä»¶æœåŠ¡
â”œâ”€â”€ pkg/                    # å…¬å…±åŒ…ï¼ˆå¯å¤ç”¨ï¼‰
â”‚   â”œâ”€â”€ jwt/               # JWTè®¤è¯
â”‚   â”œâ”€â”€ logger/            # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ markdown/          # Markdownå¤„ç†
â”‚   â”œâ”€â”€ oss/               # å¯¹è±¡å­˜å‚¨ï¼ˆé˜¿é‡Œäº‘OSSï¼‰
â”‚   â”œâ”€â”€ redis/             # Rediså®¢æˆ·ç«¯
â”‚   â””â”€â”€ response/          # HTTPå“åº”å°è£…
â”œâ”€â”€ tools/                  # å·¥å…·è„šæœ¬
â”‚   â””â”€â”€ reset_db.go        # æ•°æ®åº“é‡ç½®å·¥å…·
â”œâ”€â”€ uploads/                # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”œâ”€â”€ config.yaml             # é…ç½®æ–‡ä»¶
â”œâ”€â”€ main.go                 # ç¨‹åºå…¥å£
â”œâ”€â”€ Dockerfile              # Dockeré•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml      # Docker Composeé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- MySQL 8.0+
- Redis 7.x

### æœ¬åœ°å¼€å‘

**1. å…‹éš†é¡¹ç›®**

```bash
git clone https://github.com/ydcloud-dy/leaf-api.git
cd leaf-api
```

**2. å®‰è£…ä¾èµ–**

```bash
export GOPROXY=https://goproxy.cn,direct
go mod download
```

**3. é…ç½®æ•°æ®åº“**

ä¿®æ”¹ `config.yaml`ï¼ŒæŠŠæ•°æ®åº“é…ç½®æ”¹æˆä½ æœ¬åœ°çš„ï¼š

```yaml
database:
  host: 127.0.0.1
  port: 3306
  user: root
  password: your_password
  dbname: leaf_admin
  charset: utf8mb4
```

**4. å¯åŠ¨å¿…è¦æœåŠ¡**

```bash
# å¯åŠ¨ MySQL
mysql.server start

# å¯åŠ¨ Redis
redis-server
```

**5. è¿è¡Œé¡¹ç›®**

```bash
# ç›´æ¥è¿è¡Œ
go run main.go

# æˆ–è€…ç¼–è¯‘åè¿è¡Œ
go build -o leaf-api .
./leaf-api
```

**6. éªŒè¯æœåŠ¡**

- API æœåŠ¡: http://localhost:8888
- å¥åº·æ£€æŸ¥: http://localhost:8888/ping

å¦‚æœèƒ½è®¿é—®é€šï¼Œè¯´æ˜å¯åŠ¨æˆåŠŸäº†ã€‚

## ğŸ“¦ éƒ¨ç½²æ–¹å¼

### è£¸éƒ¨ç½²

å¦‚æœä½ æƒ³ç›´æ¥éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥ç”¨æˆ‘æä¾›çš„è‡ªåŠ¨åŒ–è„šæœ¬ï¼š

```bash
chmod +x deploy/scripts/deploy.sh
./deploy/scripts/deploy.sh
```

å½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ“ä½œï¼š

```bash
# ç¼–è¯‘
go build -o leaf-api .

# åˆ›å»ºç›®å½•
mkdir -p logs uploads

# è®°å¾—å…ˆé…ç½®å¥½ config.yaml

# å¯åŠ¨æœåŠ¡
./leaf-api

# åå°è¿è¡Œçš„è¯
nohup ./leaf-api > server.log 2>&1 &
```

### Docker éƒ¨ç½²

å…ˆæ„å»ºé•œåƒï¼š

```bash
docker build -t leaf-api:latest .
```

ç„¶åè¿è¡Œå®¹å™¨ï¼š

```bash
docker run -d \
  --name leaf-api \
  -p 8888:8888 \
  -v $(pwd)/config.yaml:/app/config.yaml \
  -v $(pwd)/uploads:/app/uploads \
  -v $(pwd)/logs:/app/logs \
  -e DB_HOST=your_mysql_host \
  -e REDIS_HOST=your_redis_host \
  leaf-api:latest
```

è®°å¾—æŠŠ MySQL å’Œ Redis çš„åœ°å€æ¢æˆå®é™…çš„ã€‚

### Docker Compose éƒ¨ç½²

**æ¨èä½¿ç”¨ Docker Compose ä¸€é”®éƒ¨ç½²åç«¯æœåŠ¡åŠå…¶ä¾èµ–**

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆAPIã€MySQLã€Redisï¼‰
docker-compose up -d

# çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down

# å¦‚æœæƒ³æ¸…ç†æ•°æ®é‡æ–°å¼€å§‹
docker-compose down -v
```

å¯åŠ¨åå¯ä»¥è®¿é—®ï¼š
- API æœåŠ¡: http://localhost:8888
- Swagger æ–‡æ¡£: http://localhost:8888/swagger/index.html

### Kubernetes éƒ¨ç½²

å¦‚æœè¦éƒ¨ç½²åˆ° K8sï¼ŒæŒ‰ä¸‹é¢æ­¥éª¤æ¥ï¼š

**åˆ›å»ºå‘½åç©ºé—´å’Œ PVC**

```bash
kubectl apply -f deploy/k8s/pvc.yaml
```

**éƒ¨ç½²åº”ç”¨**

```bash
kubectl apply -f deploy/k8s/deployment.yaml
```

**æ£€æŸ¥çŠ¶æ€**

```bash
# çœ‹ Pod çŠ¶æ€
kubectl get pods -n leaf-blog

# çœ‹æœåŠ¡
kubectl get svc -n leaf-blog

# çœ‹æ—¥å¿—
kubectl logs -f <pod-name> -n leaf-blog
```

**è®¿é—®æœåŠ¡**

```bash
# æµ‹è¯•çš„è¯å¯ä»¥ç”¨ç«¯å£è½¬å‘
kubectl port-forward svc/leaf-api-service 8888:8888 -n leaf-blog

# ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½® Ingress
```

## âš™ï¸ é…ç½®è¯´æ˜

### ä¸»è¦é…ç½®é¡¹

```yaml
server:
  port: 8888           # æœåŠ¡ç«¯å£
  mode: release        # è¿è¡Œæ¨¡å¼: debug, release, test

database:
  host: 127.0.0.1      # æ•°æ®åº“åœ°å€
  port: 3306           # æ•°æ®åº“ç«¯å£
  user: root           # æ•°æ®åº“ç”¨æˆ·
  password: 123456     # æ•°æ®åº“å¯†ç 
  dbname: leaf_admin   # æ•°æ®åº“åç§°
  charset: utf8mb4     # å­—ç¬¦é›†

jwt:
  secret: your_secret  # JWT å¯†é’¥
  expire: 24           # Token è¿‡æœŸæ—¶é—´ï¼ˆå°æ—¶ï¼‰

oss:                   # é˜¿é‡Œäº‘ OSS é…ç½®
  endpoint: oss-cn-hangzhou.aliyuncs.com
  access_key_id: your_key_id
  access_key_secret: your_key_secret
  bucket_name: your_bucket
  base_url: https://your-bucket.oss-cn-hangzhou.aliyuncs.com

redis:
  host: 127.0.0.1      # Redis åœ°å€
  port: 6379           # Redis ç«¯å£
  password:            # Redis å¯†ç 
  db: 0                # Redis æ•°æ®åº“
  pool_size: 10        # è¿æ¥æ± å¤§å°

log:
  level: debug         # æ—¥å¿—çº§åˆ«: debug, info, warn, error
  format: text         # æ—¥å¿—æ ¼å¼: text, json
  output: stdout       # è¾“å‡º: stdout, file
  file_path: logs/app.log
  max_size: 100        # å•ä¸ªæ–‡ä»¶å¤§å° (MB)
  max_backups: 3       # ä¿ç•™æ–‡ä»¶æ•°é‡
  max_age: 7           # ä¿ç•™å¤©æ•°
```

### ç¯å¢ƒå˜é‡

ä¹Ÿå¯ä»¥ç”¨ç¯å¢ƒå˜é‡è¦†ç›–é…ç½®æ–‡ä»¶ï¼Œéƒ¨ç½²æ—¶æ¯”è¾ƒæ–¹ä¾¿ï¼š

- `DB_HOST` - æ•°æ®åº“åœ°å€
- `DB_PORT` - æ•°æ®åº“ç«¯å£
- `REDIS_HOST` - Redis åœ°å€
- `REDIS_PORT` - Redis ç«¯å£

## ğŸ“– API æ–‡æ¡£

é¡¹ç›®åˆ†ä¸ºç®¡ç†åå°å’Œåšå®¢å‰å°ä¸¤å¥— APIï¼Œä¸‹é¢æ˜¯è¯¦ç»†è¯´æ˜ã€‚

### Swagger æ–‡æ¡£ï¼ˆæ¨èï¼‰

é¡¹ç›®å·²é›†æˆ Swaggerï¼Œå¯åŠ¨æœåŠ¡åå¯ä»¥ç›´æ¥è®¿é—®äº¤äº’å¼ API æ–‡æ¡£ã€‚

**è®¿é—®åœ°å€**ï¼š
- **Swagger UI**: http://localhost:8888/swagger/index.html ï¼ˆæ¨èï¼Œå¯è§†åŒ–ç•Œé¢ï¼‰
- **API JSON**: http://localhost:8888/swagger/doc.json

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- ğŸ“– è‡ªåŠ¨ç”Ÿæˆçš„ API æ–‡æ¡£ï¼Œä¸ä»£ç ä¿æŒåŒæ­¥
- ğŸ§ª å¯ä»¥ç›´æ¥åœ¨é¡µé¢ä¸Šæµ‹è¯•æ¥å£
- ğŸ” æ”¯æŒ JWT è®¤è¯æµ‹è¯•
- ğŸ“ è¯¦ç»†çš„è¯·æ±‚/å“åº”ç¤ºä¾‹

**å¿«é€Ÿå¼€å§‹**ï¼š
1. å¯åŠ¨æœåŠ¡ï¼š`./leaf-api`
2. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8888/swagger/index.html
3. ç‚¹å‡»æ¥å£å¯æŸ¥çœ‹è¯¦æƒ…ï¼Œç‚¹å‡» "Try it out" å¯æµ‹è¯•

**æ·»åŠ æ–°æ¥å£æ–‡æ¡£**ï¼š
```bash
# 1. åœ¨ä»£ç ä¸­æ·»åŠ  Swagger æ³¨é‡Šï¼ˆå‚è€ƒ internal/service/auth.goï¼‰
# 2. é‡æ–°ç”Ÿæˆæ–‡æ¡£
swag init
# 3. é‡å¯æœåŠ¡
```

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·æŸ¥çœ‹ï¼š[SWAGGER_USAGE.md](./SWAGGER_USAGE.md)

---

### ç®¡ç†åå° API

ç®¡ç†åå°çš„æ¥å£å¤§éƒ¨åˆ†éƒ½éœ€è¦ç™»å½•ï¼Œè¯·æ±‚æ—¶è¦å¸¦ä¸Š JWT Tokenã€‚

#### è®¤è¯ç›¸å…³ `/auth`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| POST | `/auth/login` | ç®¡ç†å‘˜ç™»å½• | âœ— |
| POST | `/auth/logout` | ç®¡ç†å‘˜ç™»å‡º | âœ— |
| GET | `/auth/profile` | è·å–å½“å‰ç®¡ç†å‘˜ä¿¡æ¯ | âœ“ |
| PUT | `/auth/profile` | æ›´æ–°å½“å‰ç®¡ç†å‘˜ä¿¡æ¯ | âœ“ |

#### ç”¨æˆ·ç®¡ç† `/users`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/users` | è·å–ç”¨æˆ·åˆ—è¡¨ | âœ“ |
| GET | `/users/:id` | è·å–ç”¨æˆ·è¯¦æƒ… | âœ“ |
| POST | `/users` | åˆ›å»ºç”¨æˆ· | âœ“ |
| PUT | `/users/:id` | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | âœ“ |
| DELETE | `/users/:id` | åˆ é™¤ç”¨æˆ· | âœ“ |

#### æ–‡ç« ç®¡ç† `/articles`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/articles` | è·å–æ–‡ç« åˆ—è¡¨ | âœ“ |
| GET | `/articles/:id` | è·å–æ–‡ç« è¯¦æƒ… | âœ“ |
| POST | `/articles` | åˆ›å»ºæ–‡ç«  | âœ“ |
| POST | `/articles/import` | æ‰¹é‡å¯¼å…¥ Markdown æ–‡ä»¶ | âœ“ |
| POST | `/articles/batch-update-cover` | æ‰¹é‡æ›´æ–°æ–‡ç« å°é¢ | âœ“ |
| POST | `/articles/batch-update-fields` | æ‰¹é‡æ›´æ–°æ–‡ç« å­—æ®µ | âœ“ |
| POST | `/articles/batch-delete` | æ‰¹é‡åˆ é™¤æ–‡ç«  | âœ“ |
| PUT | `/articles/:id` | æ›´æ–°æ–‡ç«  | âœ“ |
| PATCH | `/articles/:id/status` | æ›´æ–°æ–‡ç« çŠ¶æ€ï¼ˆä¸Šä¸‹æ¶ï¼‰ | âœ“ |
| DELETE | `/articles/:id` | åˆ é™¤æ–‡ç«  | âœ“ |

#### åˆ†ç±»ç®¡ç† `/categories`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/categories` | è·å–åˆ†ç±»åˆ—è¡¨ | âœ“ |
| POST | `/categories` | åˆ›å»ºåˆ†ç±» | âœ“ |
| DELETE | `/categories/:id` | åˆ é™¤åˆ†ç±» | âœ“ |

#### æ ‡ç­¾ç®¡ç† `/tags`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/tags` | è·å–æ ‡ç­¾åˆ—è¡¨ | âœ“ |
| POST | `/tags` | åˆ›å»ºæ ‡ç­¾ | âœ“ |
| DELETE | `/tags/:id` | åˆ é™¤æ ‡ç­¾ | âœ“ |

#### ç« èŠ‚ç®¡ç† `/chapters`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/chapters` | è·å–ç« èŠ‚åˆ—è¡¨ | âœ“ |
| GET | `/chapters/:id` | è·å–ç« èŠ‚è¯¦æƒ… | âœ“ |
| POST | `/chapters` | åˆ›å»ºç« èŠ‚ | âœ“ |
| PUT | `/chapters/:id` | æ›´æ–°ç« èŠ‚ | âœ“ |
| DELETE | `/chapters/:id` | åˆ é™¤ç« èŠ‚ | âœ“ |

#### è¯„è®ºç®¡ç† `/comments`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/comments` | è·å–è¯„è®ºåˆ—è¡¨ | âœ“ |
| DELETE | `/comments/:id` | åˆ é™¤è¯„è®º | âœ“ |
| PATCH | `/comments/:id/status` | æ›´æ–°è¯„è®ºçŠ¶æ€ | âœ“ |

#### ç»Ÿè®¡æ•°æ® `/stats`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/stats` | è·å–ç«™ç‚¹ç»Ÿè®¡æ•°æ® | âœ“ |
| GET | `/stats/hot-articles` | è·å–çƒ­é—¨æ–‡ç«  | âœ“ |

#### ç³»ç»Ÿè®¾ç½® `/settings`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/settings` | è·å–ç³»ç»Ÿè®¾ç½® | âœ“ |
| PUT | `/settings` | æ›´æ–°ç³»ç»Ÿè®¾ç½® | âœ“ |

#### æ–‡ä»¶ç®¡ç† `/files`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| POST | `/files/upload` | ä¸Šä¼ æ–‡ä»¶ | âœ“ |
| GET | `/files` | è·å–æ–‡ä»¶åˆ—è¡¨ | âœ“ |
| DELETE | `/files/:id` | åˆ é™¤æ–‡ä»¶ | âœ“ |

---

### åšå®¢å‰å° API

åšå®¢å‰å°çš„æ¥å£å¤§éƒ¨åˆ†æ˜¯å…¬å¼€çš„ï¼Œéƒ¨åˆ†åŠŸèƒ½ï¼ˆç‚¹èµã€è¯„è®ºç­‰ï¼‰éœ€è¦ç™»å½•ã€‚

#### è®¤è¯ç›¸å…³ `/blog/auth`

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| POST | `/blog/auth/register` | ç”¨æˆ·æ³¨å†Œ | âœ— |
| POST | `/blog/auth/login` | ç”¨æˆ·ç™»å½• | âœ— |
| GET | `/blog/auth/me` | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ | âœ“ |
| PUT | `/blog/auth/profile` | æ›´æ–°ç”¨æˆ·èµ„æ–™ | âœ“ |
| PUT | `/blog/auth/password` | ä¿®æ”¹å¯†ç  | âœ“ |

#### æ–‡ç« ç›¸å…³ï¼ˆå…¬å¼€ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/blog/articles` | è·å–æ–‡ç« åˆ—è¡¨ | âœ— |
| GET | `/blog/articles/search` | æœç´¢æ–‡ç«  | âœ— |
| GET | `/blog/articles/archive` | æ–‡ç« å½’æ¡£ | âœ— |
| GET | `/blog/articles/:id` | è·å–æ–‡ç« è¯¦æƒ…ï¼ˆå¯é€‰è®¤è¯ï¼‰ | å¯é€‰ |

#### æ–‡ç« äº’åŠ¨ï¼ˆéœ€è¦è®¤è¯ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| POST | `/blog/articles/:id/like` | ç‚¹èµæ–‡ç«  | âœ“ |
| DELETE | `/blog/articles/:id/like` | å–æ¶ˆç‚¹èµ | âœ“ |
| POST | `/blog/articles/:id/favorite` | æ”¶è—æ–‡ç«  | âœ“ |
| DELETE | `/blog/articles/:id/favorite` | å–æ¶ˆæ”¶è— | âœ“ |

#### è¯„è®ºç›¸å…³

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/blog/articles/:id/comments` | è·å–æ–‡ç« è¯„è®ºï¼ˆå¯é€‰è®¤è¯ï¼‰ | å¯é€‰ |
| POST | `/blog/comments` | å‘è¡¨è¯„è®º | âœ“ |
| POST | `/blog/comments/:id/like` | ç‚¹èµè¯„è®º | âœ“ |
| DELETE | `/blog/comments/:id/like` | å–æ¶ˆç‚¹èµè¯„è®º | âœ“ |
| DELETE | `/blog/comments/:id` | åˆ é™¤è¯„è®º | âœ“ |

#### ç•™è¨€æ¿

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/blog/guestbook` | è·å–ç•™è¨€åˆ—è¡¨ï¼ˆå¯é€‰è®¤è¯ï¼‰ | å¯é€‰ |
| POST | `/blog/guestbook` | å‘è¡¨ç•™è¨€ | âœ“ |

#### åˆ†ç±»å’Œæ ‡ç­¾ï¼ˆå…¬å¼€ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/blog/categories` | è·å–åˆ†ç±»åˆ—è¡¨ | âœ— |
| GET | `/blog/tags` | è·å–æ ‡ç­¾åˆ—è¡¨ | âœ— |
| GET | `/blog/chapters/:tag` | è·å–æ ‡ç­¾ä¸‹çš„ç« èŠ‚åŠæ–‡ç«  | âœ— |

#### ç”¨æˆ·æ•°æ®ï¼ˆéœ€è¦è®¤è¯ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/blog/user/likes` | è·å–ç”¨æˆ·ç‚¹èµåˆ—è¡¨ | âœ“ |
| GET | `/blog/user/favorites` | è·å–ç”¨æˆ·æ”¶è—åˆ—è¡¨ | âœ“ |
| GET | `/blog/user/stats` | è·å–ç”¨æˆ·ç»Ÿè®¡æ•°æ® | âœ“ |

#### ç»Ÿè®¡å’Œåšä¸»ä¿¡æ¯ï¼ˆå…¬å¼€ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| GET | `/blog/stats` | è·å–ç«™ç‚¹ç»Ÿè®¡ | âœ— |
| GET | `/blog/stats/hot-articles` | è·å–çƒ­é—¨æ–‡ç«  | âœ— |
| GET | `/blog/blogger` | è·å–åšä¸»ä¿¡æ¯ | âœ— |

#### åœ¨çº¿è¿½è¸ªï¼ˆå¯é€‰è®¤è¯ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æ˜¯å¦éœ€è¦è®¤è¯ |
|------|------|------|--------------|
| POST | `/blog/heartbeat` | è®°å½•å¿ƒè·³ï¼ˆåœ¨çº¿çŠ¶æ€ï¼‰ | å¯é€‰ |
| POST | `/blog/visit` | è®°å½•è®¿é—®æ—¶é•¿ | å¯é€‰ |

**è¯´æ˜**ï¼š
- âœ“ éœ€è¦ç™»å½•ï¼Œè¯·æ±‚å¤´å¸¦ä¸Š `Authorization: Bearer <token>`
- âœ— ä¸éœ€è¦ç™»å½•
- å¯é€‰ è¡¨ç¤ºç™»å½•å’Œä¸ç™»å½•éƒ½è¡Œï¼Œç™»å½•åèƒ½çœ‹åˆ°æ›´å¤šä¿¡æ¯ï¼ˆæ¯”å¦‚ç‚¹èµçŠ¶æ€ï¼‰

## ğŸ”§ å¼€å‘ç›¸å…³

### è¿è¡Œæµ‹è¯•

```bash
go test ./...
```

### ä»£ç æ ¼å¼åŒ–

```bash
go fmt ./...
```

### ä»£ç æ£€æŸ¥

```bash
go vet ./...
```

### ä¾èµ–æ³¨å…¥

é¡¹ç›®ä½¿ç”¨äº† Google Wire åšä¾èµ–æ³¨å…¥ï¼Œå¦‚æœä¿®æ”¹äº† `cmd/wire.go`ï¼Œè®°å¾—é‡æ–°ç”Ÿæˆä»£ç ï¼š

```bash
# å®‰è£… wireï¼ˆé¦–æ¬¡ï¼‰
go install github.com/google/wire/cmd/wire@latest

# ç”Ÿæˆä¾èµ–æ³¨å…¥ä»£ç 
cd cmd && wire
```

### ç”Ÿæˆ API æ–‡æ¡£

é¡¹ç›®æ”¯æŒ Swagger è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼š

```bash
# å®‰è£… swagï¼ˆé¦–æ¬¡ï¼‰
go install github.com/swaggo/swag/cmd/swag@latest

# ç”Ÿæˆæ–‡æ¡£
swag init

# å¯åŠ¨æœåŠ¡åè®¿é—®
# http://localhost:8888/swagger/index.html
```

## ğŸ“ è¯´æ˜

- é¡¹ç›®æ¶æ„å‚è€ƒäº† [Kratos](https://go-kratos.dev/) æ¡†æ¶çš„è®¾è®¡æ€æƒ³
- ä½¿ç”¨ MIT åè®®å¼€æº
- å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ Star â­

## ğŸ“ åé¦ˆ
å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ [Issue](https://github.com/ydcloud-dy/leaf-ui-frontend/issues)
- å‘é€é‚®ä»¶è‡³ï¼šdycloudlove@163.com
- ğŸ“¡ï¼š![img.png](wx.png)

